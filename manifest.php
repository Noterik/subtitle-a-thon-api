<?php

$dff_conversion['https://vimeo.com/251303116']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/1/FE_Autom%C3%B3vil_a_h%C3%A9lice.mp4';
$dff_conversion['https://vimeo.com/251305107']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/2/FE_Boda_elegante.mp4';
$dff_conversion['https://vimeo.com/251303173']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/3/FE_Bellezas_Auvernia.mp4';
$dff_conversion['https://vimeo.com/251304579']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/4/FE_Patatas_fritas.mp4';
$dff_conversion['https://vimeo.com/251303995']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/5/FE_Logrono.mp4';
$dff_conversion['https://vimeo.com/525615820']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/6/DFF_Kaskeline_Kaba-Lied_SD.mp4';
$dff_conversion['https://vimeo.com/524898134']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/7/DFF_Kaskeline_Anatomie-Eines-Hafens_SD.mp4';
$dff_conversion['https://vimeo.com/524909325']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/8/DFF_Kaskeline_Zauber-Im-Zeichentrick_SD.mp4';
$dff_conversion['https://vimeo.com/255578719']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/9/die-frankfurter-kleinstwohnung.mp4';
$dff_conversion['https://vimeo.com/255533898']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/10/dif_dif-die_frankfurter_kueche_logo.mp4';
$dff_conversion['https://vimeo.com/255578661']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/11/neues-bauen-in-frankfurt.mp4';
$dff_conversion['https://vimeo.com/215146234']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/12/LE-CAPIAGE_MPEG4_25FPS_SD_LG_BUMP.mp4';
$dff_conversion['https://vimeo.com/215196652']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/13/PRESTATIES_MP4_LG_SD.mp4';
$dff_conversion['https://vimeo.com/214178707']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/14/Schoenmaker%20blijf%20bij%20uw%20leest.mp4';
$dff_conversion['https://vimeo.com/215025166']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/15/TEMPS-PERDU_MPEG4_25FPS_SD_LG_BUMP.mp4';
$dff_conversion['https://vimeo.com/215798051']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/16/SECOURS-HIVER_MPEG4_25FPS_SD_LG_BUMP.mp4';
$dff_conversion['https://vimeo.com/212925170']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/17/BLOEMENCOMPO_MPEG4_SD_LG_BUMP.mp4';
$dff_conversion['https://vimeo.com/215673673']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/18/DRIE-WATERKUURSTEDEN_LG_MP4_25FPS_SD.mp4';
$dff_conversion['https://vimeo.com/203302548']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/19/14074_ZUR-GESCHICHTE_MPEG4_18@25fps_PAL.mp4';
$dff_conversion['https://vimeo.com/200340704']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/20/13852_ANNIV-HAELEN_MPEG4_16@25fps_PAL.mp4';
$dff_conversion['https://vimeo.com/208310501']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/21/13805_ALBERT-I-ROI_MPEG4_18@25fps_PAL.mp4';
$dff_conversion['https://vimeo.com/208312403']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/22/13806_REED-BLESSES_MPEG4_18@25FPS_SD_LG_BUMP.mp4';
$dff_conversion['https://vimeo.com/207489442']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/23/13800_FRIDOLIN-GUERRE_MPEG4_16@25fps_PAL.mp4';
$dff_conversion['https://vimeo.com/251304414']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/24/FE_Alcalde de Zalamea.mp4';
$dff_conversion['https://vimeo.com/251303260']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/25/FE_Alagon.mp4';
$dff_conversion['https://vimeo.com/251305131']['url'] = 'https://stream20.noterik.com/progressive/stream20/domain/subtitleathon/user/dff/video/26/FE_Madrid Alfonso XIII.mp4';

$dff_conversion['https://vimeo.com/251303116']['duration'] = '341.30';
$dff_conversion['https://vimeo.com/251303116']['width'] = '720';
$dff_conversion['https://vimeo.com/251303116']['height'] = '540';
$dff_conversion['https://vimeo.com/251305107']['duration'] = '117.83';
$dff_conversion['https://vimeo.com/251305107']['width'] = '720';
$dff_conversion['https://vimeo.com/251305107']['height'] = '540';
$dff_conversion['https://vimeo.com/251303173']['duration'] = '400.65';
$dff_conversion['https://vimeo.com/251303173']['width'] = '720';
$dff_conversion['https://vimeo.com/251303173']['height'] = '540';
$dff_conversion['https://vimeo.com/251304579']['duration'] = '290.37';
$dff_conversion['https://vimeo.com/251304579']['width'] = '720';
$dff_conversion['https://vimeo.com/251304579']['height'] = '540';
$dff_conversion['https://vimeo.com/251303995']['duration'] = '383.42';
$dff_conversion['https://vimeo.com/251303995']['width'] = '720';
$dff_conversion['https://vimeo.com/251303995']['height'] = '540';
$dff_conversion['https://vimeo.com/525615820']['duration'] = '127.70';
$dff_conversion['https://vimeo.com/525615820']['width'] = '740';
$dff_conversion['https://vimeo.com/525615820']['height'] = '540';
$dff_conversion['https://vimeo.com/524898134']['duration'] = '586.84';
$dff_conversion['https://vimeo.com/524898134']['width'] = '700';
$dff_conversion['https://vimeo.com/524898134']['height'] = '540';
$dff_conversion['https://vimeo.com/524909325']['duration'] = '702.08';
$dff_conversion['https://vimeo.com/524909325']['width'] = '700';
$dff_conversion['https://vimeo.com/524909325']['height'] = '540';
$dff_conversion['https://vimeo.com/255578719']['duration'] = '327.51';
$dff_conversion['https://vimeo.com/255578719']['width'] = '1920';
$dff_conversion['https://vimeo.com/255578719']['height'] = '1080';
$dff_conversion['https://vimeo.com/255533898']['duration'] = '481.88';
$dff_conversion['https://vimeo.com/255533898']['width'] = '1920';
$dff_conversion['https://vimeo.com/255533898']['height'] = '1080';
$dff_conversion['https://vimeo.com/255578661']['duration'] = '655.10';
$dff_conversion['https://vimeo.com/255578661']['width'] = '1920';
$dff_conversion['https://vimeo.com/255578661']['height'] = '1080';
$dff_conversion['https://vimeo.com/215146234']['duration'] = '381.40';
$dff_conversion['https://vimeo.com/215146234']['width'] = '1024';
$dff_conversion['https://vimeo.com/215146234']['height'] = '576';
$dff_conversion['https://vimeo.com/215196652']['duration'] = '414.08';
$dff_conversion['https://vimeo.com/215196652']['width'] = '768';
$dff_conversion['https://vimeo.com/215196652']['height'] = '576';
$dff_conversion['https://vimeo.com/214178707']['duration'] = '424.52';
$dff_conversion['https://vimeo.com/214178707']['width'] = '768';
$dff_conversion['https://vimeo.com/214178707']['height'] = '576';
$dff_conversion['https://vimeo.com/215025166']['duration'] = '158.04';
$dff_conversion['https://vimeo.com/215025166']['width'] = '1024';
$dff_conversion['https://vimeo.com/215025166']['height'] = '576';
$dff_conversion['https://vimeo.com/215798051']['duration'] = '654.27';
$dff_conversion['https://vimeo.com/215798051']['width'] = '1024';
$dff_conversion['https://vimeo.com/215798051']['height'] = '576';
$dff_conversion['https://vimeo.com/212925170']['duration'] = '463.40';
$dff_conversion['https://vimeo.com/212925170']['width'] = '1024';
$dff_conversion['https://vimeo.com/212925170']['height'] = '576';
$dff_conversion['https://vimeo.com/215673673']['duration'] = '955.15';
$dff_conversion['https://vimeo.com/215673673']['width'] = '768';
$dff_conversion['https://vimeo.com/215673673']['height'] = '576';
$dff_conversion['https://vimeo.com/203302548']['duration'] = '786.48';
$dff_conversion['https://vimeo.com/203302548']['width'] = '768';
$dff_conversion['https://vimeo.com/203302548']['height'] = '576';
$dff_conversion['https://vimeo.com/200340704']['duration'] = '425.40';
$dff_conversion['https://vimeo.com/200340704']['width'] = '768';
$dff_conversion['https://vimeo.com/200340704']['height'] = '576';
$dff_conversion['https://vimeo.com/208310501']['duration'] = '480.08';
$dff_conversion['https://vimeo.com/208310501']['width'] = '768';
$dff_conversion['https://vimeo.com/208310501']['height'] = '576';
$dff_conversion['https://vimeo.com/208312403']['duration'] = '661.24';
$dff_conversion['https://vimeo.com/208312403']['width'] = '768';
$dff_conversion['https://vimeo.com/208312403']['height'] = '576';
$dff_conversion['https://vimeo.com/207489442']['duration'] = '1236.84';
$dff_conversion['https://vimeo.com/207489442']['width'] = '768';
$dff_conversion['https://vimeo.com/207489442']['height'] = '576';
$dff_conversion['https://vimeo.com/251304414']['duration'] = '1784.53';
$dff_conversion['https://vimeo.com/251304414']['width'] = '720';
$dff_conversion['https://vimeo.com/251304414']['height'] = '540';
$dff_conversion['https://vimeo.com/251303260']['duration'] = '326.37';
$dff_conversion['https://vimeo.com/251303260']['width'] = '720';
$dff_conversion['https://vimeo.com/251303260']['height'] = '540';
$dff_conversion['https://vimeo.com/251305131']['duration'] = '156.07';
$dff_conversion['https://vimeo.com/251305131']['width'] = '720';
$dff_conversion['https://vimeo.com/251305131']['height'] = '540';

//Get manifest from param
if (isset($_GET["manifest"])) {
    $manifest = $_GET["manifest"];

    $manifestFile = file_get_contents($manifest);
    //print_r($manifestFile);

    $manifestBody = json_decode($manifestFile, true);

    //get media url
    $mediaUrl = $manifestBody['items'][0]['items'][0]['items'][0]['body']['id'];

    if (strpos($mediaUrl, "https://vimeo.com/") !== false) {
        $manifestBody['items'][0]['items'][0]['items'][0]['body']['id'] = $dff_conversion[$mediaUrl]['url'];
        $manifestBody['items'][0]['items'][0]['items'][0]['body']['format'] = "video/mp4";
        $manifestBody['items'][0]['items'][0]['items'][0]['body']['type'] = "Video";

        $manifestBody['items'][0]['duration'] = $dff_conversion[$mediaUrl]['duration'];
        $manifestBody['items'][0]['width'] = $dff_conversion[$mediaUrl]['width'];
        $manifestBody['items'][0]['height'] = $dff_conversion[$mediaUrl]['height'];
    } else if (strpos($mediaUrl, "http://www.euscreen.eu") === false) {
        //convert to proxy url
        $manifestBody['items'][0]['items'][0]['items'][0]['body']['id'] =  "https://api.subtitleathon.eu/proxy.php?file=".urlencode($mediaUrl);
    }

    //print
    header('Content-Type: application/json; profile="http://iiif.io/api/presentation/3/context.json";charset=UTF-8');
    print(json_encode($manifestBody));
} else {
    header("HTTP/1.0 404 Not Found");
}

?>